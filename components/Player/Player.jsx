import React, {useEffect, useState} from 'react';
import {View, Text, StyleSheet, TouchableOpacity} from "react-native";
import { WebView } from "react-native-webview";
import {normalize} from "../../styles/mainStyles";
import Slider from "react-native-sliders";
import Svg, {Defs, G, Path} from "react-native-svg";
import {connect} from "react-redux";

const Player = ({isSmall, ...props}) => {
  const [value, setValue] = useState(12)
  const [isPause, setIsPause] = useState(false)
  return (
    <>
      {props.soundInfo?.Sounds?.map(sound => <WebView
        key={sound}
        originWhitelist={["*"]}
        androidHardwareAccelerationDisabled={true}
        source={{
          html: isPause
            ? `<style>
          #frequency {
          width:100%;
        }
        </style>
        <input id="frequency" type="range" min=20 max=20000 value=${sound} >
        <br>
        <script>
          var context;
          window.AudioContext = window.AudioContext||window.webkitAudioContext;
          context = new AudioContext();
          var oscillator = context.createOscillator();
          oscillator.frequency.value = document.getElementById('frequency').value;
          oscillator.connect(context.destination);
          oscillator.start();
        </script>`
            : ``,
        }}
        style={{
          display: "none",
        }}
      />)}
      <View style={styles.player}>
        <Text style={styles.time}>00:40</Text>
        <View>
          <View style={styles.controls}>
            {isPause ? <TouchableOpacity>
              <Svg width={isSmall ? 78 : 102} height={isSmall ? 47 : 64} viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                <Path d="M8.65806 15.62L24.2116 6.11505C24.368 6.01952 24.5469 5.96735 24.7301 5.96393C24.9133 5.9605 25.094 6.00593 25.2538 6.09554C25.4136 6.18516 25.5467 6.31572 25.6392 6.47381C25.7318 6.63189 25.7806 6.81179 25.7806 6.99499V26.0049C25.7806 26.1881 25.7318 26.368 25.6392 26.5261C25.5467 26.6842 25.4136 26.8148 25.2538 26.9044C25.094 26.994 24.9133 27.0394 24.7301 27.036C24.5469 27.0326 24.368 26.9804 24.2116 26.8849L8.65806 17.3799C8.50731 17.2878 8.38276 17.1585 8.29635 17.0044C8.20993 16.8503 8.16455 16.6766 8.16455 16.5C8.16455 16.3233 8.20993 16.1496 8.29635 15.9955C8.38276 15.8414 8.50731 15.7121 8.65806 15.62Z" fill="#fff" stroke="#fff" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                <Path d="M7.21875 5.15625V27.8438" stroke="#fff" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
              </Svg>

            </TouchableOpacity> : <TouchableOpacity>
              <Svg width={isSmall ? 78 : 102} height={isSmall ? 47 : 64} viewBox="0 0 92 54" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                <G filter="url(#filter0_ii)">
                  <G filter="url(#filter1_d)">
                    <Path
                      d="M47.7438 28.44L76.023 43.9936C76.3072 44.1499 76.6326 44.2353 76.9656 44.2409C77.2987 44.2465 77.6274 44.1722 77.9179 44.0255C78.2084 43.8789 78.4503 43.6652 78.6186 43.4066C78.787 43.1479 78.8757 42.8535 78.8757 42.5537L78.8757 11.4465C78.8757 11.1467 78.787 10.8524 78.6186 10.5937C78.4503 10.335 78.2084 10.1213 77.9179 9.97469C77.6274 9.82805 77.2987 9.75371 76.9656 9.75932C76.6326 9.76493 76.3072 9.85028 76.023 10.0066L47.7438 25.5602C47.4697 25.7109 47.2432 25.9225 47.0861 26.1747C46.929 26.4268 46.8465 26.711 46.8465 27.0001C46.8465 27.2892 46.929 27.5734 47.0861 27.8256C47.2432 28.0777 47.4697 28.2893 47.7438 28.44Z"
                      fill="#FBFBFB"/>
                    <Path
                      d="M47.7438 28.44L76.023 43.9936C76.3072 44.1499 76.6326 44.2353 76.9656 44.2409C77.2987 44.2465 77.6274 44.1722 77.9179 44.0255C78.2084 43.8789 78.4503 43.6652 78.6186 43.4066C78.787 43.1479 78.8757 42.8535 78.8757 42.5537L78.8757 11.4465C78.8757 11.1467 78.787 10.8524 78.6186 10.5937C78.4503 10.335 78.2084 10.1213 77.9179 9.97469C77.6274 9.82805 77.2987 9.75371 76.9656 9.75932C76.6326 9.76493 76.3072 9.85028 76.023 10.0066L47.7438 25.5602C47.4697 25.7109 47.2432 25.9225 47.0861 26.1747C46.929 26.4268 46.8465 26.711 46.8465 27.0001C46.8465 27.2892 46.929 27.5734 47.0861 27.8256C47.2432 28.0777 47.4697 28.2893 47.7438 28.44Z"
                      stroke="#6F94D1" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                    <Path
                      d="M47.7438 28.44L76.023 43.9936C76.3072 44.1499 76.6326 44.2353 76.9656 44.2409C77.2987 44.2465 77.6274 44.1722 77.9179 44.0255C78.2084 43.8789 78.4503 43.6652 78.6186 43.4066C78.787 43.1479 78.8757 42.8535 78.8757 42.5537L78.8757 11.4465C78.8757 11.1467 78.787 10.8524 78.6186 10.5937C78.4503 10.335 78.2084 10.1213 77.9179 9.97469C77.6274 9.82805 77.2987 9.75371 76.9656 9.75932C76.6326 9.76493 76.3072 9.85028 76.023 10.0066L47.7438 25.5602C47.4697 25.7109 47.2432 25.9225 47.0861 26.1747C46.929 26.4268 46.8465 26.711 46.8465 27.0001C46.8465 27.2892 46.929 27.5734 47.0861 27.8256C47.2432 28.0777 47.4697 28.2893 47.7438 28.44Z"
                      stroke="white" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                  </G>
                </G>
                <G filter="url(#filter2_ii)">
                  <G filter="url(#filter3_d)">
                    <Path
                      d="M16.0061 28.44L44.7567 43.9936C45.0457 44.1499 45.3765 44.2353 45.7151 44.2409C46.0537 44.2465 46.3878 44.1722 46.6832 44.0255C46.9786 43.8789 47.2245 43.6652 47.3956 43.4066C47.5668 43.1479 47.657 42.8535 47.657 42.5537L47.657 11.4465C47.657 11.1467 47.5668 10.8524 47.3956 10.5937C47.2245 10.335 46.9786 10.1213 46.6832 9.97469C46.3878 9.82805 46.0537 9.75371 45.7151 9.75932C45.3765 9.76493 45.0457 9.85028 44.7567 10.0066L16.0061 25.5602C15.7275 25.7109 15.4973 25.9225 15.3375 26.1747C15.1778 26.4268 15.0939 26.711 15.0939 27.0001C15.0939 27.2892 15.1778 27.5734 15.3375 27.8256C15.4973 28.0777 15.7275 28.2893 16.0061 28.44Z"
                      fill="#FBFBFB"/>
                    <Path
                      d="M16.0061 28.44L44.7567 43.9936C45.0457 44.1499 45.3765 44.2353 45.7151 44.2409C46.0537 44.2465 46.3878 44.1722 46.6832 44.0255C46.9786 43.8789 47.2245 43.6652 47.3956 43.4066C47.5668 43.1479 47.657 42.8535 47.657 42.5537L47.657 11.4465C47.657 11.1467 47.5668 10.8524 47.3956 10.5937C47.2245 10.335 46.9786 10.1213 46.6832 9.97469C46.3878 9.82805 46.0537 9.75371 45.7151 9.75932C45.3765 9.76493 45.0457 9.85028 44.7567 10.0066L16.0061 25.5602C15.7275 25.7109 15.4973 25.9225 15.3375 26.1747C15.1778 26.4268 15.0939 26.711 15.0939 27.0001C15.0939 27.2892 15.1778 27.5734 15.3375 27.8256C15.4973 28.0777 15.7275 28.2893 16.0061 28.44Z"
                      stroke="#6F94D1" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                    <Path
                      d="M16.0061 28.44L44.7567 43.9936C45.0457 44.1499 45.3765 44.2353 45.7151 44.2409C46.0537 44.2465 46.3878 44.1722 46.6832 44.0255C46.9786 43.8789 47.2245 43.6652 47.3956 43.4066C47.5668 43.1479 47.657 42.8535 47.657 42.5537L47.657 11.4465C47.657 11.1467 47.5668 10.8524 47.3956 10.5937C47.2245 10.335 46.9786 10.1213 46.6832 9.97469C46.3878 9.82805 46.0537 9.75371 45.7151 9.75932C45.3765 9.76493 45.0457 9.85028 44.7567 10.0066L16.0061 25.5602C15.7275 25.7109 15.4973 25.9225 15.3375 26.1747C15.1778 26.4268 15.0939 26.711 15.0939 27.0001C15.0939 27.2892 15.1778 27.5734 15.3375 27.8256C15.4973 28.0777 15.7275 28.2893 16.0061 28.44Z"
                      stroke="white" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                  </G>
                </G>
              </Svg>
            </TouchableOpacity>}
            {isPause ? <TouchableOpacity onPress={() => setIsPause(false)}>
              <Svg width={isSmall ? 63 : 94} height={isSmall ? 60 : 96} viewBox="0 0 41 41" fill="z" xmlns="http://www.w3.org/2000/svg">
                <Path d="M32.0312 6.40625H26.2656C25.558 6.40625 24.9844 6.97989 24.9844 7.6875V33.3125C24.9844 34.0201 25.558 34.5938 26.2656 34.5938H32.0312C32.7389 34.5938 33.3125 34.0201 33.3125 33.3125V7.6875C33.3125 6.97989 32.7389 6.40625 32.0312 6.40625Z" fill="#fff" stroke="#fff" stroke-width="3.04669" stroke-linecap="round" stroke-linejoin="round"/>
                <Path d="M14.7344 6.40625H8.96875C8.26114 6.40625 7.6875 6.97989 7.6875 7.6875V33.3125C7.6875 34.0201 8.26114 34.5938 8.96875 34.5938H14.7344C15.442 34.5938 16.0156 34.0201 16.0156 33.3125V7.6875C16.0156 6.97989 15.442 6.40625 14.7344 6.40625Z" fill="#fff" stroke="#fff" stroke-width="3.04669" stroke-linecap="round" stroke-linejoin="round"/>
              </Svg>

            </TouchableOpacity> : <TouchableOpacity onPress={() => setIsPause(true)} activeOpacity={0.6}>
              <Svg width={isSmall ? 63 : 94} height={isSmall ? 60 : 96} viewBox="0 0 84 86" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                <G filter="url(#filter0_d)">
                  <Path
                    d="M61.9588 40.7068L22.3678 15.9363C21.9699 15.6873 21.5144 15.5514 21.0481 15.5425C20.5819 15.5335 20.1217 15.6519 19.715 15.8855C19.3082 16.119 18.9696 16.4593 18.7339 16.8713C18.4983 17.2832 18.374 17.7521 18.374 18.2295V67.7706C18.374 68.248 18.4983 68.7168 18.7339 69.1288C18.9696 69.5408 19.3082 69.8811 19.715 70.1146C20.1217 70.3481 20.5819 70.4665 21.0481 70.4576C21.5144 70.4487 21.9699 70.3127 22.3678 70.0638L61.9588 45.2932C62.3425 45.0532 62.6595 44.7162 62.8795 44.3146C63.0995 43.9131 63.215 43.4604 63.215 43C63.215 42.5396 63.0995 42.087 62.8795 41.6854C62.6595 41.2839 62.3425 40.9469 61.9588 40.7068Z"
                    fill="#FBFBFB"/>
                  <Path
                    d="M61.9588 40.7068L22.3678 15.9363C21.9699 15.6873 21.5144 15.5514 21.0481 15.5425C20.5819 15.5335 20.1217 15.6519 19.715 15.8855C19.3082 16.119 18.9696 16.4593 18.7339 16.8713C18.4983 17.2832 18.374 17.7521 18.374 18.2295V67.7706C18.374 68.248 18.4983 68.7168 18.7339 69.1288C18.9696 69.5408 19.3082 69.8811 19.715 70.1146C20.1217 70.3481 20.5819 70.4665 21.0481 70.4576C21.5144 70.4487 21.9699 70.3127 22.3678 70.0638L61.9588 45.2932C62.3425 45.0532 62.6595 44.7162 62.8795 44.3146C63.0995 43.9131 63.215 43.4604 63.215 43C63.215 42.5396 63.0995 42.087 62.8795 41.6854C62.6595 41.2839 62.3425 40.9469 61.9588 40.7068Z"
                    stroke="#6F94D1" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                  <Path
                    d="M61.9588 40.7068L22.3678 15.9363C21.9699 15.6873 21.5144 15.5514 21.0481 15.5425C20.5819 15.5335 20.1217 15.6519 19.715 15.8855C19.3082 16.119 18.9696 16.4593 18.7339 16.8713C18.4983 17.2832 18.374 17.7521 18.374 18.2295V67.7706C18.374 68.248 18.4983 68.7168 18.7339 69.1288C18.9696 69.5408 19.3082 69.8811 19.715 70.1146C20.1217 70.3481 20.5819 70.4665 21.0481 70.4576C21.5144 70.4487 21.9699 70.3127 22.3678 70.0638L61.9588 45.2932C62.3425 45.0532 62.6595 44.7162 62.8795 44.3146C63.0995 43.9131 63.215 43.4604 63.215 43C63.215 42.5396 63.0995 42.087 62.8795 41.6854C62.6595 41.2839 62.3425 40.9469 61.9588 40.7068Z"
                    stroke="white" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                </G>
              </Svg>
            </TouchableOpacity>}
            {isPause ? <TouchableOpacity>
              <Svg width={isSmall ? 70 : 102} height={isSmall ? 47 : 64} viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                <Path d="M24.3411 15.62L8.7875 6.11505C8.63118 6.01952 8.45222 5.96735 8.26905 5.96393C8.08588 5.9605 7.9051 6.00593 7.74531 6.09554C7.58552 6.18516 7.45249 6.31572 7.3599 6.47381C7.26731 6.63189 7.21851 6.81179 7.21851 6.99499V26.0049C7.21851 26.1881 7.26731 26.368 7.3599 26.5261C7.45249 26.6842 7.58552 26.8148 7.74531 26.9044C7.9051 26.994 8.08588 27.0394 8.26905 27.036C8.45222 27.0326 8.63118 26.9804 8.7875 26.8849L24.3411 17.3799C24.4918 17.2878 24.6164 17.1585 24.7028 17.0044C24.7892 16.8503 24.8346 16.6766 24.8346 16.5C24.8346 16.3233 24.7892 16.1496 24.7028 15.9955C24.6164 15.8414 24.4918 15.7121 24.3411 15.62Z" fill="#fff" stroke="#fff" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                <Path d="M25.781 5.15625V27.8438" stroke="#fff" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
              </Svg>
            </TouchableOpacity> : <TouchableOpacity>
              <Svg width={isSmall ? 78 : 102} height={isSmall ? 47 : 64} viewBox="0 0 92 54" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                <G filter="url(#filter0_ii)">
                  <G filter="url(#filter1_d)">
                    <Path
                      d="M44.2562 25.56L15.977 10.0064C15.6928 9.85005 15.3674 9.76469 15.0344 9.75908C14.7013 9.75347 14.3726 9.82782 14.0821 9.97446C13.7916 10.1211 13.5497 10.3348 13.3814 10.5934C13.213 10.8521 13.1243 11.1465 13.1243 11.4463V42.5535C13.1243 42.8533 13.213 43.1476 13.3814 43.4063C13.5497 43.665 13.7916 43.8787 14.0821 44.0253C14.3726 44.172 14.7013 44.2463 15.0344 44.2407C15.3674 44.2351 15.6928 44.1497 15.977 43.9934L44.2562 28.4398C44.5303 28.2891 44.7568 28.0775 44.9139 27.8253C45.071 27.5732 45.1535 27.289 45.1535 26.9999C45.1535 26.7108 45.071 26.4266 44.9139 26.1744C44.7568 25.9223 44.5303 25.7107 44.2562 25.56Z"
                      fill="#FBFBFB"/>
                    <Path
                      d="M44.2562 25.56L15.977 10.0064C15.6928 9.85005 15.3674 9.76469 15.0344 9.75908C14.7013 9.75347 14.3726 9.82782 14.0821 9.97446C13.7916 10.1211 13.5497 10.3348 13.3814 10.5934C13.213 10.8521 13.1243 11.1465 13.1243 11.4463V42.5535C13.1243 42.8533 13.213 43.1476 13.3814 43.4063C13.5497 43.665 13.7916 43.8787 14.0821 44.0253C14.3726 44.172 14.7013 44.2463 15.0344 44.2407C15.3674 44.2351 15.6928 44.1497 15.977 43.9934L44.2562 28.4398C44.5303 28.2891 44.7568 28.0775 44.9139 27.8253C45.071 27.5732 45.1535 27.289 45.1535 26.9999C45.1535 26.7108 45.071 26.4266 44.9139 26.1744C44.7568 25.9223 44.5303 25.7107 44.2562 25.56Z"
                      stroke="#6F94D1" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                    <Path
                      d="M44.2562 25.56L15.977 10.0064C15.6928 9.85005 15.3674 9.76469 15.0344 9.75908C14.7013 9.75347 14.3726 9.82782 14.0821 9.97446C13.7916 10.1211 13.5497 10.3348 13.3814 10.5934C13.213 10.8521 13.1243 11.1465 13.1243 11.4463V42.5535C13.1243 42.8533 13.213 43.1476 13.3814 43.4063C13.5497 43.665 13.7916 43.8787 14.0821 44.0253C14.3726 44.172 14.7013 44.2463 15.0344 44.2407C15.3674 44.2351 15.6928 44.1497 15.977 43.9934L44.2562 28.4398C44.5303 28.2891 44.7568 28.0775 44.9139 27.8253C45.071 27.5732 45.1535 27.289 45.1535 26.9999C45.1535 26.7108 45.071 26.4266 44.9139 26.1744C44.7568 25.9223 44.5303 25.7107 44.2562 25.56Z"
                      stroke="white" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                  </G>
                </G>
                <G filter="url(#filter2_ii)">
                  <G filter="url(#filter3_d)">
                    <Path
                      d="M75.9939 25.56L47.2433 10.0064C46.9543 9.85005 46.6235 9.76469 46.2849 9.75908C45.9463 9.75347 45.6122 9.82782 45.3168 9.97446C45.0214 10.1211 44.7755 10.3348 44.6044 10.5934C44.4332 10.8521 44.343 11.1465 44.343 11.4463V42.5535C44.343 42.8533 44.4332 43.1476 44.6044 43.4063C44.7755 43.665 45.0214 43.8787 45.3168 44.0253C45.6122 44.172 45.9463 44.2463 46.2849 44.2407C46.6235 44.2351 46.9543 44.1497 47.2433 43.9934L75.9939 28.4398C76.2725 28.2891 76.5027 28.0775 76.6625 27.8253C76.8222 27.5732 76.9061 27.289 76.9061 26.9999C76.9061 26.7108 76.8222 26.4266 76.6625 26.1744C76.5027 25.9223 76.2725 25.7107 75.9939 25.56Z"
                      fill="#FBFBFB"/>
                    <Path
                      d="M75.9939 25.56L47.2433 10.0064C46.9543 9.85005 46.6235 9.76469 46.2849 9.75908C45.9463 9.75347 45.6122 9.82782 45.3168 9.97446C45.0214 10.1211 44.7755 10.3348 44.6044 10.5934C44.4332 10.8521 44.343 11.1465 44.343 11.4463V42.5535C44.343 42.8533 44.4332 43.1476 44.6044 43.4063C44.7755 43.665 45.0214 43.8787 45.3168 44.0253C45.6122 44.172 45.9463 44.2463 46.2849 44.2407C46.6235 44.2351 46.9543 44.1497 47.2433 43.9934L75.9939 28.4398C76.2725 28.2891 76.5027 28.0775 76.6625 27.8253C76.8222 27.5732 76.9061 27.289 76.9061 26.9999C76.9061 26.7108 76.8222 26.4266 76.6625 26.1744C76.5027 25.9223 76.2725 25.7107 75.9939 25.56Z"
                      stroke="#6F94D1" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                    <Path
                      d="M75.9939 25.56L47.2433 10.0064C46.9543 9.85005 46.6235 9.76469 46.2849 9.75908C45.9463 9.75347 45.6122 9.82782 45.3168 9.97446C45.0214 10.1211 44.7755 10.3348 44.6044 10.5934C44.4332 10.8521 44.343 11.1465 44.343 11.4463V42.5535C44.343 42.8533 44.4332 43.1476 44.6044 43.4063C44.7755 43.665 45.0214 43.8787 45.3168 44.0253C45.6122 44.172 45.9463 44.2463 46.2849 44.2407C46.6235 44.2351 46.9543 44.1497 47.2433 43.9934L75.9939 28.4398C76.2725 28.2891 76.5027 28.0775 76.6625 27.8253C76.8222 27.5732 76.9061 27.289 76.9061 26.9999C76.9061 26.7108 76.8222 26.4266 76.6625 26.1744C76.5027 25.9223 76.2725 25.7107 75.9939 25.56Z"
                      stroke="white" stroke-width="2.71546" stroke-linecap="round" stroke-linejoin="round"/>
                  </G>
                </G>
              </Svg>
            </TouchableOpacity>}
          </View>
          <Slider
            value={value}
            onValueChange={(value) => setValue(value)}
            trackStyle={{...styles.track, height: isPause ? 8 : isSmall ? 13 : 18, backgroundColor: isPause ? '#fff' : '#fff'}}
            thumbStyle={{
              ...styles.thumb, width: isPause ? 16 : isSmall ? 26 : 35, height: isPause ? 16 : isSmall ? 26 : 35,
              backgroundColor: isPause ? '#fff' : '#C0C0C0'
            }}
            maximumValue={30}
            minimumValue={0}
            minimumTrackTintColor={isPause ? '#fff' : '#fff'}
            maximumTrackTintColor={isPause ? '#fff' : "#fff"}
          />
        </View>
        <Text style={styles.time}>12:45</Text>
      </View>
    </>
  );
};

const styles = StyleSheet.create({
  player: {
    marginLeft: 10,
    flexDirection: 'row',
    alignItems: 'flex-end',
  },
  time: {
    fontSize: normalize(20),
    marginHorizontal: 14,
    fontFamily: 'Roboto',
    color: 'white',
    marginBottom: 10
  },
  controls: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between'
  },
  track: {
    borderRadius: 34,
    shadowColor: "rgba(0, 0, 0, 0.25)",
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowRadius: 2.22,
    elevation: 4,
  },
  thumb: {
    borderRadius: 500,
    shadowColor: "rgba(0, 0, 0, 0.25)",
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowRadius: 2.22,
    elevation: 12,
  }
})

const mapStateToProps = (state) => ({
  soundInfo: state.subscriptionReducer.soundInfo
})


export default connect(mapStateToProps, {})(Player)
